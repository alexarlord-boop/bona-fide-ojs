(function(e){"use strict";const p={__name:"TrustScoreUI",props:{submissionId:Number},setup(m){console.log("BUILD TEST: "+Math.random());const{useUrl:o}=pkp.modules.useUrl,{useFetch:n}=pkp.modules.useFetch,l=m,c=e.ref({}),i=e.ref([]),u=e.ref([]),{apiUrl:b}=o(`submissions/${l.submissionId}`),{data:a,fetch:g}=n(b);g().then(()=>{console.log("Fetched submission data:",a.value),c.value=a.value}).catch(s=>{console.error("Error fetching submission data:",s)});const{apiUrl:h}=o(`submissions/${l.submissionId}/publications/${l.submissionId}`),{data:d,fetch:f}=n(h),k=async()=>{f().then(()=>{var s;console.log("Fetched publication data:",d.value),i.value=((s=d.value)==null?void 0:s.authors)||[]}).catch(s=>{console.error("Error fetching publication data:",s)})},w=async()=>{if(a.value&&a.value.reviewAssignments){const s=a.value.reviewAssignments.map(r=>r.reviewerId);for(const r of s){const{apiUrl:t}=o(`users/${r}`),{data:y,fetch:S}=n(t);await S(),u.value.push(y.value)}console.log("Fetched reviewers:",u)}else console.warn("No review assignments found in submission data.")};return e.watch(a,s=>{s&&(k(),w(),console.log("authors",i),console.log("reviewers",u))}),(s,r)=>(e.openBlock(),e.createElementBlock("div",null,[r[0]||(r[0]=e.createElementVNode("h3",null,"Authors",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,t=>(e.openBlock(),e.createElementBlock("ul",{key:t.id},[e.createElementVNode("li",null,e.toDisplayString(t.id)+" "+e.toDisplayString(t.fullName)+" "+e.toDisplayString(t.email),1)]))),128)),r[1]||(r[1]=e.createElementVNode("h3",null,"Reviewers",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,t=>(e.openBlock(),e.createElementBlock("ul",{key:t.id},[e.createElementVNode("li",null,e.toDisplayString(t.id)+" "+e.toDisplayString(t.fullName)+" "+e.toDisplayString(t.email),1)]))),128)),e.createElementVNode("pre",null,e.toDisplayString(i.value),1)]))}};pkp.registry.registerComponent("TrustScoreUI",p),pkp.registry.storeExtend("workflow",m=>{const o=m.store;o.extender.extendFn("getMenuItems",n=>(n.push({key:"trustScoreTab",label:"Bona Fide",component:"TrustScoreUI",title:"Bona Fide",icon:"AnonymousReview",items:[{key:"overview",label:"Trust Overview",state:{primaryMenuItem:"trustScoreTab",secondaryMenuItem:"overview",title:"Bona Fide: Trust Overview"}}]}),n)),o.extender.extendFn("getPrimaryItems",n=>{var l,c,i;return o.selectedMenuState.secondaryMenuItem==="overview"&&(window.trustScoresData||(c=(l=window.pkp)==null?void 0:l.state)!=null&&c.trustScores||(i=o.state)!=null&&i.trustScores,n.push({key:"overview",component:"TrustScoreUI",props:{submissionId:o.submissionId}})),n})})})(pkp.modules.vue);
