(function(e){"use strict";const k=(r,t)=>{const l=r.__vccOpts||r;for(const[n,s]of t)l[n]=s;return l},E={name:"ExampleTab",props:{initData:{type:Object,required:!0}},data(){return{authors:this.initData.authors.map(r=>({...r,score:"-1"})),reviewers:this.initData.reviewers.map(r=>({...r,score:"-1"})),editor:this.initData.editor,journal_title:this.initData.journal_title,submission_id:this.initData.submission_id,submission_title:this.initData.submission_title,accordionState:{}}},mounted(){this.fetchScores("author",this.authors),this.fetchScores("reviewer",this.reviewers),console.log("Mounted example-tab component with initial data:",this.initData)},methods:{toggleAccordion(r){this.$set(this.accordionState,r,!this.accordionState[r])},getScoreClass(r){if(r==="Error")return"score-error";const t=parseFloat(r);return isNaN(t)?"score-unknown":t>=80?"score-high":t>=50?"score-medium":"score-low"},async fetchScores(r,t){try{const n=await(await fetch("http://localhost:8000/bulk-verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:r,users:t})})).json();n&&n.users&&t.forEach((s,a)=>{s.score=n.users[a].score})}catch(l){console.error("Error fetching scores:",l),t.forEach(n=>n.score="Error")}},async exportToPDF(){try{const r=await fetch("http://localhost:8000/export-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({authors:this.authors,reviewers:this.reviewers,editor:this.editor,journal_title:this.journal_title,submission_id:this.submission_id,submission_title:this.submission_title})});if(!r.ok)throw new Error("PDF generation failed");const t=await r.blob(),l=window.URL.createObjectURL(t),n=document.createElement("a");n.href=l,n.download="trust-report.pdf",document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(l)}catch(r){console.error("Failed to export PDF:",r),alert("Failed to export PDF")}}}},N={class:"example-tab"},h={class:"table table-striped table-bordered flex",style:{width:"100%"}},V={style:{width:"10%"}},f=["onClick"],g={key:0},y={key:1},_=["href"],b={style:{"line-height":"17px","line-break":"loose","padding-right":"5px"}},x=["href"],B={style:{"text-align":"center"}},S={key:1},w={key:0},C={colspan:"5"},D={class:"accordion-content"},P={class:"progress-bar-container"},T={key:0},F={class:"progress-bar-container"},j={key:0},O={class:"progress-bar-container"},R={key:0},A={class:"table table-striped table-bordered",style:{width:"100%"}},L={style:{width:"10%"}},U=["href"],I={style:{"text-align":"center"}},z={key:1};function H(r,t,l,n,s,a){const d=e.resolveComponent("PkpTooltip"),m=e.resolveComponent("PkpSpinner"),p=e.resolveComponent("PkpBadge"),i=e.resolveComponent("PkpProgressBar"),q=e.resolveComponent("PkpButton"),M=e.resolveComponent("PkpHeader");return e.openBlock(),e.createElementBlock("div",N,[t[15]||(t[15]=e.createElementVNode("h3",null,"Authors",-1)),e.createElementVNode("table",h,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[1]||(t[1]=e.createElementVNode("th",{style:{width:"20%","text-align":"left"}},"Name",-1)),t[2]||(t[2]=e.createElementVNode("th",{style:{width:"20%","text-align":"left"}},"Email",-1)),t[3]||(t[3]=e.createElementVNode("th",{style:{width:"30%","text-align":"left"}},"Affiliation",-1)),t[4]||(t[4]=e.createElementVNode("th",{style:{width:"20%","text-align":"left"}},[e.createElementVNode("img",{src:"https://orcid.org/sites/default/files/images/orcid_16x16.png",alt:"ORCID",style:{"vertical-align":"middle"}}),e.createTextVNode(" ORCID ")],-1)),e.createElementVNode("th",V,[t[0]||(t[0]=e.createTextVNode("Trust Score ")),e.createVNode(d,{tooltip:"Trust score based on author's reputation, past performance and relations.",label:"Tooltip for the author trust score."})])])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.authors,(o,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o.name},[e.createElementVNode("tr",null,[e.createElementVNode("td",{onClick:G=>a.toggleAccordion(c),style:{cursor:"pointer"}},[e.createTextVNode(e.toDisplayString(o.name)+" ",1),s.accordionState[c]?(e.openBlock(),e.createElementBlock("span",g,"▼")):(e.openBlock(),e.createElementBlock("span",y,"▶"))],8,f),e.createElementVNode("td",null,[e.createElementVNode("a",{href:"mailto:"+o.email},e.toDisplayString(o.email),9,_)]),e.createElementVNode("td",b,e.toDisplayString(o.affiliation.en),1),e.createElementVNode("td",null,[o.orcid?(e.openBlock(),e.createElementBlock("a",{key:0,href:o.orcid,target:"_blank"},e.toDisplayString(o.orcid.split("/").pop()),9,x)):e.createCommentVNode("",!0)]),e.createElementVNode("td",B,[e.createVNode(p,{label:"trust score",class:e.normalizeClass(a.getScoreClass(o.score))},{default:e.withCtx(()=>[o.score==="-1"?(e.openBlock(),e.createBlock(m,{key:0})):(e.openBlock(),e.createElementBlock("strong",S,e.toDisplayString(o.score),1))]),_:2},1032,["class"])])]),s.accordionState[c]?(e.openBlock(),e.createElementBlock("tr",w,[e.createElementVNode("td",C,[e.createElementVNode("div",D,[e.createElementVNode("div",P,[t[5]||(t[5]=e.createElementVNode("strong",null,"Affiliation Score:",-1)),o.score!=="-1"?(e.openBlock(),e.createElementBlock("span",T,e.toDisplayString(parseFloat(o.score))+" / 100",1)):e.createCommentVNode("",!0),e.createVNode(i,{value:o.score==="-1"?0:parseFloat(o.score),max:100},null,8,["value"])]),e.createElementVNode("div",F,[t[6]||(t[6]=e.createElementVNode("strong",null,"Reputation Score:",-1)),o.score!=="-1"?(e.openBlock(),e.createElementBlock("span",j,e.toDisplayString((parseFloat(o.score)*.8).toFixed(2))+" / 100",1)):e.createCommentVNode("",!0),e.createVNode(i,{value:o.score==="-1"?0:parseFloat(o.score)*.8,max:100},null,8,["value"])]),e.createElementVNode("div",O,[t[7]||(t[7]=e.createElementVNode("strong",null,"Performance Score:",-1)),o.score!=="-1"?(e.openBlock(),e.createElementBlock("span",R,e.toDisplayString((parseFloat(o.score)*.6).toFixed(2))+" / 100",1)):e.createCommentVNode("",!0),e.createVNode(i,{value:o.score==="-1"?0:parseFloat(o.score)*.6,max:100},null,8,["value"])])])])])):e.createCommentVNode("",!0)],64))),128))])]),t[16]||(t[16]=e.createElementVNode("br",null,null,-1)),t[17]||(t[17]=e.createElementVNode("hr",{style:{"border-top":"3px dashed #bbb"}},null,-1)),t[18]||(t[18]=e.createElementVNode("h3",{class:"mt-1"},"Reviewers",-1)),e.createElementVNode("table",A,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[9]||(t[9]=e.createElementVNode("th",{style:{width:"25%","text-align":"left"}},"Name",-1)),t[10]||(t[10]=e.createElementVNode("th",{style:{width:"25%","text-align":"left"}},"Email",-1)),t[11]||(t[11]=e.createElementVNode("th",{style:{width:"20%","text-align":"left"}},"Affiliation",-1)),t[12]||(t[12]=e.createElementVNode("th",{style:{width:"20%","text-align":"center"}},null,-1)),e.createElementVNode("th",L,[t[8]||(t[8]=e.createTextVNode("Trust Score ")),e.createVNode(d,{tooltip:"Trust score based on reviewer's reputation, past performance and relations.",label:"Tooltip for the reviewer trust score."})])])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.reviewers,o=>(e.openBlock(),e.createElementBlock("tr",{key:o.name},[e.createElementVNode("td",null,e.toDisplayString(o.name),1),e.createElementVNode("td",null,[e.createElementVNode("a",{href:"mailto:"+o.email},e.toDisplayString(o.email),9,U)]),e.createElementVNode("td",null,e.toDisplayString(o.affiliation.en),1),t[13]||(t[13]=e.createElementVNode("td",null,null,-1)),e.createElementVNode("td",I,[e.createVNode(p,{label:"trust score",class:e.normalizeClass(a.getScoreClass(o.score))},{default:e.withCtx(()=>[o.score==="-1"?(e.openBlock(),e.createBlock(m,{key:0})):(e.openBlock(),e.createElementBlock("strong",z,e.toDisplayString(o.score),1))]),_:2},1032,["class"])])]))),128))])]),e.createVNode(M,null,{actions:e.withCtx(()=>[e.createVNode(q,{onClick:a.exportToPDF},{default:e.withCtx(()=>t[14]||(t[14]=[e.createTextVNode("Export PDF")])),_:1,__:[14]},8,["onClick"])]),_:1})])}const J=k(E,[["render",H],["__scopeId","data-v-eca4a85e"]]);pkp.Vue.component("ExampleTab",J)})(pkp.Vue);
